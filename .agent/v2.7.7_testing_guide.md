# ChroLens Mimic v2.7.7 測試指南

## 🎯 測試目標

驗證新的間隔模式時間格式是否正常工作

## ✅ 測試前檢查清單

- [ ] 已更新版本到 2.7.7
- [ ] 已修改 text_script_editor.py
- [ ] 已創建轉換工具

## 🧪 測試項目

### 測試 1: 錄製功能測試（核心）

**步驟：**

1. 啟動 ChroLens Mimic
2. 點擊「錄製」按鈕
3. 執行以下操作：
   - 按下鍵盤 `a` 鍵（停留 50ms）
   - 等待 1 秒
   - 點擊滑鼠左鍵（任意位置）
   - 等待 500ms
   - 移動滑鼠到另一個位置
4. 停止錄製
5. 點擊「腳本編輯器」查看生成的腳本

**預期結果：**
腳本應該類似：

```
>按a,50ms
>間隔1000ms
>左鍵點擊(100,200),50ms
>間隔500ms
>移動至(300,400),0ms
```

**檢查點：**

- [ ] 無 `T=0s000` 時間戳
- [ ] 使用 `>間隔XXms` 指令
- [ ] 逗號後無空格（`,50ms` 而非 `, 50ms`）
- [ ] 間隔時間計算正確

---

### 測試 2: 舊格式自動轉換測試

**前置準備：**
創建一個舊格式測試腳本 `test_old_format.json`：

```json
{
  "events": [
    {
      "type": "keyboard",
      "event": "down",
      "name": "a",
      "time": 0.0,
      "_auto_pair": true
    },
    {
      "type": "keyboard",
      "event": "up",
      "name": "a",
      "time": 0.05,
      "_auto_pair": true
    },
    {
      "type": "delay",
      "duration": 1.0,
      "time": 0.05
    }
  ],
  "settings": {
    "speed": "100",
    "repeat": "1"
  }
}
```

**步驟：**

1. 將上述 JSON 儲存到 `scripts/test_old_format.json`
2. 在 Mimic 中載入此腳本
3. 查看腳本編輯器

**預期結果：**

- [ ] 顯示「格式自動轉換」通知
- [ ] 腳本已轉換為新格式
- [ ] 可以正常儲存

---

### 測試 3: 腳本執行測試

**步驟：**

1. 使用測試 1 錄製的腳本
2. 點擊「執行」按鈕
3. 觀察執行過程

**預期結果：**

- [ ] 動作按正確順序執行
- [ ] 間隔時間正確（例如 1 秒間隔確實等待 1 秒）
- [ ] 無錯誤訊息

---

### 測試 4: 批次轉換工具測試

**步驟：**

1. 確保 `scripts/` 資料夾中有一些舊格式腳本
2. 執行 `main\轉換腳本格式.bat`
3. 查看轉換結果

**預期結果：**

- [ ] 創建備份資料夾
- [ ] 所有腳本已轉換
- [ ] 顯示轉換統計

---

## 🐛 已知問題與解決方案

### 問題 1: 執行時找不到 `>間隔` 指令

**症狀：** 執行腳本時報錯「未知指令」
**原因：** 主程式可能還沒有 `>間隔` 指令的解析邏輯
**解決：** 需要在主程式中添加解析支援（待修改）

### 問題 2: 轉換後的腳本無法儲存

**症狀：** 儲存時出錯
**原因：** 可能需要更新儲存邏輯
**解決：** 檢查錯誤訊息，可能需要額外修改

### 問題 3: 時間間隔不準確

**症狀：** 執行時間與預期不符
**原因：** 間隔計算邏輯問題
**解決：** 檢查 `add_action_with_interval` 函數的計算

---

## 📊 測試結果記錄

### 測試 1: 錄製功能

- 狀態: [ ] 通過 / [ ] 失敗
- 問題: ******\_\_\_******
- 截圖: ******\_\_\_******

### 測試 2: 自動轉換

- 狀態: [ ] 通過 / [ ] 失敗
- 問題: ******\_\_\_******

### 測試 3: 腳本執行

- 狀態: [ ] 通過 / [ ] 失敗
- 問題: ******\_\_\_******

### 測試 4: 批次轉換

- 狀態: [ ] 通過 / [ ] 失敗
- 問題: ******\_\_\_******

---

## 🔄 測試後續步驟

### 如果測試通過：

1. 繼續修改剩餘事件類型（圖片辨識、變數等）
2. 更新指令參考手冊
3. 更新官網文檔
4. 準備發布 v2.7.7

### 如果測試失敗：

1. 記錄錯誤訊息
2. 檢查相關代碼
3. 修復問題
4. 重新測試

---

## 💡 測試技巧

1. **逐步測試**：先測試最簡單的功能（錄製），再測試複雜的
2. **保留日誌**：如果出錯，查看控制台輸出
3. **備份腳本**：測試前備份重要腳本
4. **對比測試**：用舊版本對比新版本的行為

---

## 📞 遇到問題？

如果測試中遇到問題，請記錄：

1. 具體操作步驟
2. 錯誤訊息（完整）
3. 預期結果 vs 實際結果
4. 相關截圖

這些資訊將幫助快速定位和修復問題。
