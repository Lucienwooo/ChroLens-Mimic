# ChroLens Mimic 指令語法參考

## ⚠️ 重要說明

本文件列出 **實際支援的指令語法**,所有範例和文件都已經過驗證,確保與主程式邏輯一致。

---

## 📋 基本規則

### 指令格式
```
>動作, 參數, T=時間戳
```

### 時間戳格式
- `T=0s000` = 0 秒 0 毫秒
- `T=1s500` = 1 秒 500 毫秒
- 時間戳由錄製功能自動生成,手寫時可省略

---

## 🏷️ 標籤與跳轉

### 定義標籤
```
#標籤名稱
```

### 跳轉到標籤
```
>>#標籤名稱
```
- `>>` 表示成功分支跳轉
- 常用於循環和條件成功時的跳轉

### 失敗分支跳轉
```
>>>#標籤名稱
```
- `>>>` 表示失敗分支跳轉
- 用於條件不成立時的跳轉

### ❌ 錯誤語法
```
>跳轉#標籤名稱  ❌ 不存在此指令!
```

---

## 🖼️ 圖片辨識

### 基本圖片辨識
```
>辨識>pic01, T=0s000
>移動至>pic01, T=0s000
>左鍵點擊>pic01, T=0s000
```

### 圖片條件判斷
```
>if>pic01, T=0s000
>>左鍵點擊>pic02, T=0s100    # 找到時執行
>>>延遲1000ms, T=0s100        # 沒找到時執行
```

### 圖片辨識選項
```
>if>pic01, 邊框, T=0s000                    # 顯示邊框除錯
>if>pic01, 範圍(0,0,1920,500), T=0s000      # 指定搜尋範圍
>if>pic01, 邊框, 範圍(0,0,1920,500), T=0s000  # 組合使用
```

### ❌ 錯誤語法
```
>左鍵點擊, AI:pic01  ❌ 錯誤!應該是 >左鍵點擊>pic01
>>左鍵點擊, AI:pic01, 偏移(0,0)  ❌ 錯誤!
```

---

## 🤖 YOLO AI 辨識

### AI 標籤格式
```
>if>AI:enemy, T=0s000
>>左鍵點擊>AI:enemy, T=0s100
>>移動至>AI:enemy, T=0s200
```

### AI 辨識選項
```
>if>AI:enemy, 門檻(0.7), T=0s000
>YOLO偵測>enemy, 門檻(0.6), 範圍(0,0,1920,1080), T=0s000
```

### ✅ 正確語法
```
>左鍵點擊>AI:enemy     ✅ 正確
>移動至>AI:enemy       ✅ 正確
```

### ❌ 錯誤語法
```
>左鍵點擊, AI:enemy    ❌ 錯誤!逗號應該是 >
>移動至, AI:enemy      ❌ 錯誤!
```

---

## 🖱️ 滑鼠操作

### 基本滑鼠指令
```
>左鍵點擊(100,200), 延遲50ms, T=0s000
>右鍵點擊(100,200), 延遲50ms, T=0s000
>移動至(100,200), 延遲0ms, T=0s000
>滾輪(1), 延遲0ms, T=0s000
```

### 無座標點擊 (當前位置)
```
>左鍵點擊, 延遲50ms, T=0s000
>右鍵點擊, 延遲50ms, T=0s000
```

---

## ⌨️ 鍵盤操作

### 基本按鍵
```
>按a, 延遲50ms, T=0s000
>按Enter, 延遲50ms, T=0s000
>按F1, 延遲50ms, T=0s000
```

### 組合鍵
```
>按下Ctrl, 延遲0ms, T=0s000
>按C, 延遲50ms, T=0s000
>放開Ctrl, 延遲0ms, T=0s050
```

---

## 🔄 流程控制

### 條件判斷
```
>if>pic01, T=0s000
>>左鍵點擊>pic02, T=0s100     # 成功分支
>>>延遲1000ms, T=0s100         # 失敗分支
```

### 循環
```
>重複>10次, T=0s000
  >按1, 延遲50ms, T=0s000
  >延遲1000ms, T=0s050
>重複結束, T=10s000
```

### 無限循環
```
#主循環
>按1, 延遲50ms, T=0s000
>延遲800ms, T=0s050
>>#主循環, T=0s850
```

---

## ⚡ 觸發器系統

### 定時觸發
```
>定時觸發>5秒
>按F, 延遲50ms
>定時結束
```

### 條件觸發
```
>條件觸發>pic怪物, 冷卻2000ms
>左鍵點擊>pic怪物
>按1, 延遲50ms
>條件結束
```

### 優先偵測
```
>優先偵測>pic血量低
>按2, 延遲50ms
>延遲500ms
>優先偵測結束
```

---

## 🔢 變數系統

### 變數操作
```
>設定變數>count, 0, T=0s000
>變數加1>count, T=1s000
>變數減1>count, T=2s000
```

### 變數條件
```
>if變數>count, >=, 10, T=0s000
>>#完成, T=0s100
>>>#繼續, T=0s100
```

---

## 🤖 狀態機

### 狀態機定義
```
>狀態機>戰鬥AI
>狀態>待機, 初始
>if>AI:enemy
>切換>success>攻擊
>狀態>攻擊
>左鍵點擊>AI:enemy
>切換>default>待機
>狀態機結束
```

---

## 📝 OCR 文字辨識

### 文字條件判斷
```
>if文字>登入, T=0s000
>>#找到, T=0s100
>>>#沒找到, T=0s100
```

### 等待文字出現
```
>等待文字>完成, 最長10s, T=0s000
```

### 點擊文字
```
>點擊文字>確認, T=0s000
```

---

## ⏱️ 延遲控制

### 固定延遲
```
>延遲1000ms, T=0s000
```

### 隨機延遲
```
>隨機延遲>100ms,500ms, T=0s000
```

---

## ✅ 常見錯誤對照表

| ❌ 錯誤語法 | ✅ 正確語法 | 說明 |
|------------|------------|------|
| `>跳轉#標籤` | `>>#標籤` | 沒有「跳轉」指令 |
| `>左鍵點擊, AI:pic01` | `>左鍵點擊>pic01` | 逗號應該是 > |
| `>移動至, AI:enemy` | `>移動至>AI:enemy` | 逗號應該是 > |
| `>>左鍵點擊, AI:pic01, 偏移(0,0)` | `>>左鍵點擊>pic01, 偏移(0,0)` | AI: 只用於 YOLO 標籤 |

---

## 📚 完整範例

### 遊戲掛機腳本
```
# 主循環
#主循環
>按1, 延遲50ms, T=0s000
>延遲800ms, T=0s050
>>#主循環, T=0s850

# 背景撿道具
>定時觸發>5秒
>按F, 延遲50ms
>定時結束

# 緊急補血
>優先偵測>pic血量低
>按2, 延遲50ms
>優先偵測結束
```

---

## 🔍 驗證方法

1. **查看主程式**: `text_script_editor.py` 第 3200-3240 行
2. **參考範例模板**: `templates/` 資料夾
3. **使用錄製功能**: 自動生成正確語法
4. **查看指令說明**: 主程式內建的指令參考視窗

---

**最後更新**: 2026-01-09  
**版本**: v2.8.2+
