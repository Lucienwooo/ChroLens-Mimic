# ChroLens Blockly 風格指令編輯器

## 📋 功能說明

這是基於 `sample_13_blockly_tabs.py` UI 設計，完整整合 `text_script_editor.py` 所有功能的 Blockly 風格指令編輯器。

### ✨ 主要特色

#### 🎨 Blockly 風格 UI
- **紫色主題**：專業的 Blockly 配色方案
- **三欄式佈局**：左側工具箱、中央編輯器、右側屬性
- **分頁工具箱**：操作/鍵盤/控制/辨識 四大類別
- **積木式設計**：點擊積木即可插入對應指令

#### 📝 完整編輯功能
- ✅ 文字指令編輯器（VS Code 深色主題）
- ✅ 語法高亮顯示
- ✅ 摺疊軌跡顯示
- ✅ 腳本載入/儲存
- ✅ 自訂模組管理

#### ⚡ 快速指令插入
- 🖱️ **記錄滑鼠**：快速記錄滑鼠座標
- ⌨️ **快速輸入**：插入文字輸入指令
- ⏰ **插入等待**：添加延遲控制
- 📸 **截圖辨識**：截圖並自動插入指令
- 🏷️ **新增標籤**：創建跳轉標籤
- 📋 **指令說明**：查看完整語法參考

#### ⚙️ 屬性設定
- 回放速度控制（%）
- 重複次數設定
- 重複時間設定
- 重複間隔設定

#### 📦 模組管理
- 儲存常用指令組合為模組
- 一鍵插入已儲存模組
- 模組管理（新增/刪除）

## 🚀 使用方法

### 方法 1：直接執行
```bash
python blockly_script_editor.py
```

### 方法 2：使用啟動器
```bash
python 啟動編輯器.py
```

### 方法 3：從主程式呼叫
```python
from blockly_script_editor import BlocklyScriptEditor

editor = BlocklyScriptEditor(script_path="path/to/script.json")
editor.run()
```

## 📚 指令語法

### 滑鼠操作
```
移動 100, 200          # 移動滑鼠到座標 (100, 200)
點擊 左                # 點擊左鍵
點擊 右, 2             # 連續點擊右鍵2次
拖曳 100,100 到 200,200  # 拖曳滑鼠
滾輪 向上, 3           # 向上滾動3次
```

### 鍵盤操作
```
按鍵 enter             # 按下 Enter 鍵
輸入 Hello World       # 輸入文字
組合 ctrl, c           # 按下 Ctrl+C
按住 shift, 1.0        # 按住 Shift 鍵 1 秒
```

### 流程控制
```
等待 1.5               # 等待 1.5 秒
標籤:開始               # 定義標籤
跳到 開始               # 跳轉到標籤
```

### 圖片辨識
```
找圖 pic01             # 尋找並點擊圖片
找字 確定按鈕           # OCR 文字辨識
截圖 0,0,100,100 > pic_area  # 截圖並儲存
```

### 註解
```
# 這是註解，不會執行
```

## 🎯 UI 佈局說明

### 左側工具箱（280px）
- **操作標籤**：滑鼠移動、點擊、拖曳、滾輪
- **鍵盤標籤**：按鍵、輸入、組合鍵、按住
- **控制標籤**：等待、跳轉、條件、迴圈
- **辨識標籤**：圖片、OCR、截圖、顏色

### 中央編輯器（展開填滿）
- **標題列**：顯示編輯器名稱、摺疊軌跡選項
- **文字編輯器**：
  - VS Code 深色主題 (#1e1e1e)
  - 語法高亮顯示
  - LINE Seed 字體（若可用）
  - 支援復原/重做
  - 右鍵選單

### 右側屬性面板（320px）
- **屬性設定**：
  - 回放速度（%）
  - 重複次數
  - 重複時間
  - 重複間隔
  
- **模組管理**：
  - 儲存模組按鈕
  - 插入模組按鈕
  - 刪除模組按鈕
  - 模組列表（雙擊插入）

### 底部快速指令區（100px）
6個快速指令按鈕，點擊即可執行對應功能

## 🔧 技術特點

### UI 設計
- ✅ Blockly 風格配色（#5c6bc0 主色調）
- ✅ 三欄式佈局，比例固定
- ✅ 標籤式工具箱分類
- ✅ 積木可點擊插入
- ✅ 現代化扁平化設計

### 功能整合
- ✅ 完整的 JSON ↔ 文字指令轉換
- ✅ 語法高亮（VS Code Dark+ 配色）
- ✅ 模組儲存與管理
- ✅ 圖片辨識支援
- ✅ 腳本載入/儲存

### 相容性
- ✅ 與原 text_script_editor.py 格式完全相容
- ✅ 支援所有 ChroLens 指令
- ✅ JSON 格式與主程式一致
- ✅ 可獨立執行或整合使用

## 📁 檔案結構

```
UI Test/
├── blockly_script_editor.py    # 主程式
├── 啟動編輯器.py                # 啟動器
└── README.md                    # 說明文件（本檔）
```

## 🎨 配色方案

### Blockly 主題色
- **主色調**：#5c6bc0（紫藍色）
- **背景色**：#f0f0f0（淺灰）
- **編輯器**：#1e1e1e（VS Code 深色）
- **白色面板**：#ffffff

### 積木顏色
- **滑鼠操作**：#42a5f5（藍色系）
- **鍵盤操作**：#66bb6a（綠色系）
- **流程控制**：#ffa726（橘色系）
- **圖片辨識**：#ab47bc（紫色系）

### 語法高亮
- **註解**：#6a9955（綠色）
- **滑鼠**：#569cd6（藍色）
- **鍵盤**：#9cdcfe（淺藍）
- **時間**：#ce9178（橘色）
- **標籤**：#4ec9b0（青綠）
- **圖片**：#4ec9b0（青綠）

## 🐛 已知限制

1. **MSS 截圖**：需要安裝 `mss` 和 `numpy` 套件（選用）
2. **LINE Seed 字體**：需要 `pyglet` 套件和字體檔案（選用）
3. **軌跡摺疊**：簡化版本，基本功能已實現
4. **圖片辨識**：需要 PIL/Pillow 套件

## 💡 使用建議

1. **新手**：從左側積木點擊開始，熟悉指令格式
2. **進階**：直接在編輯器中輸入指令，享受語法高亮
3. **模組化**：將常用指令組合儲存為模組，提高效率
4. **快捷鍵**：使用底部快速按鈕加速工作流程

## 🔄 更新記錄

### v1.0 (2025-01-10)
- ✅ 初版發布
- ✅ 完整整合 text_script_editor 功能
- ✅ Blockly 風格 UI 設計
- ✅ 四大類別標籤工具箱
- ✅ 語法高亮與模組管理

## 📞 技術支援

如有問題或建議，請參考主程式 `ChroLens_Mimic.py` 的相關文件。

---

**ChroLens Blockly Editor** - 讓自動化腳本編寫更簡單、更直覺！
