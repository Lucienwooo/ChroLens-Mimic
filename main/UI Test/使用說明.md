# ChroLens Blockly 風格編輯器 - 使用說明

## 🎨 Figma 風格畫布模式

### 功能特色
✅ **可拖曳浮動工具箱** - 按住標題列可自由移動
✅ **視覺化流程畫布** - 節點式編輯，直觀易懂
✅ **左側標籤工具箱** - 四大分類：操作/鍵盤/控制/辨識
✅ **雙模式切換** - 畫布模式 ↔ 文字模式隨時切換
✅ **自動連接節點** - 新增節點自動連接到前一個
✅ **完整功能保留** - 所有原編輯器功能完整保留

## 📖 快速上手

### 1. 啟動編輯器
```bash
python blockly_script_editor.py
```
或
```bash
python 啟動編輯器.py
```

### 2. 使用浮動工具箱
- **點擊工具** - 在畫布上創建對應節點
- **拖曳工具箱** - 按住標題列"🔧 工具箱"可移動位置
- **最小化** - 點擊 "−" 按鈕收起工具箱
- **切換分類** - 左側標籤切換時，工具箱內容同步更新

### 3. 編輯畫布節點
- **創建節點** - 從工具箱點擊或從左側積木列表點擊
- **移動節點** - 按住節點拖曳到任意位置
- **自動連接** - 新節點自動連接到前一個，形成流程
- **右鍵選單** - 在畫布空白處右鍵，可清空/自動排列/轉換文字

### 4. 模式切換
- **畫布模式** - 視覺化節點編輯（預設）
- **文字模式** - 傳統文字指令編輯
- **切換按鈕** - 頂部右側"文字模式"按鈕
- **雙向同步** - 儲存時自動同步兩種模式

## 🎯 四大工具分類

### 操作標籤（藍色）
- 移動滑鼠 - 移動到指定座標
- 滑鼠點擊 - 點擊左/右/中鍵
- 滑鼠拖曳 - 從點A拖到點B
- 滑鼠滾輪 - 向上/向下滾動

### 鍵盤標籤（綠色）
- 按下鍵盤 - 按下單一按鍵
- 輸入文字 - 輸入文字內容
- 組合鍵 - Ctrl+C、Ctrl+V等
- 按住鍵盤 - 按住指定時間

### 控制標籤（橘色）
- 等待時間 - 延遲執行
- 標籤 - 設定跳轉點
- 條件判斷 - 條件式執行
- 迴圈 - 重複執行

### 辨識標籤（紫色）
- 圖片辨識 - 尋找並點擊圖片
- OCR文字 - 文字辨識
- 截圖區域 - 截取螢幕區域
- 顏色偵測 - 偵測顏色

## 📝 範例腳本

已預載 **blockly_demo_script** 測試腳本，包含：
1. 移動滑鼠到 (500, 300)
2. 點擊左鍵
3. 全選文字 (Ctrl+A)
4. 輸入 "ChroLens Blockly 測試腳本"
5. 按下 Enter
6. 移動到 (800, 400)
7. 點擊右鍵開啟選單
8. 選擇選單項目
9. 儲存 (Ctrl+S)
10. 確認

### 載入測試
1. 選擇腳本：blockly_demo_script
2. 點擊「重新載入」
3. 觀察畫布上出現 18 個連接的節點
4. 拖曳任一節點查看連接線自動調整
5. 右鍵畫布 → 自動排列

## 🔧 進階操作

### 浮動工具箱技巧
1. **定位** - 拖到畫布任意位置
2. **收起** - 點擊 "−" 最小化節省空間
3. **同步** - 左側標籤切換時內容自動更新
4. **快速插入** - 點擊工具即創建節點

### 節點編輯技巧
1. **對齊** - 右鍵 → 自動排列 → 垂直對齊
2. **清空** - 右鍵 → 清空畫布 → 重新開始
3. **轉文字** - 右鍵 → 轉換為文字 → 切換模式
4. **自由擺放** - 拖曳節點可任意排列

### 工作流程建議
1. **視覺化設計** - 在畫布模式快速搭建流程
2. **微調參數** - 切換文字模式精確修改
3. **儲存測試** - 儲存後在主程式執行測試
4. **迭代優化** - 重新載入繼續編輯

## 🎨 UI 佈局

```
┌─────────────────────────────────────────────────────────────┐
│  🎯 ChroLens Blockly 指令編輯器     [腳本選擇] [載入][儲存] │
├───────┬─────────────────────────────────────────────┬───────┤
│       │                                             │       │
│  操作 │          🎨 視覺化編輯畫布                   │  ⚙️   │
│  鍵盤 │                                             │  屬性 │
│  控制 │   ┌─────────┐                              │  設定 │
│  辨識 │   │🔧工具箱 │   [節點] → [節點] → [節點]    │       │
│       │   │         │           ↓                  │  📦   │
│ [積木]│   │ 移動    │        [節點]                │  模組 │
│ [列表]│   │ 點擊    │           ↓                  │  管理 │
│       │   │ 拖曳    │        [節點]                │       │
│       │   └─────────┘                              │       │
├───────┴─────────────────────────────────────────────┴───────┤
│  ⚡ 快速指令: [🖱️記錄][⌨️輸入][⏰等待][📸截圖][🏷️標籤][📋說明] │
└─────────────────────────────────────────────────────────────┘
```

## 🚀 特色功能

### 1. 智能連接
- 新節點自動連接到前一個
- 連接線隨節點移動自動調整
- 視覺化流程一目了然

### 2. 雙向同步
- 畫布 → 文字：右鍵選單轉換
- 文字 → 畫布：載入時自動顯示
- 儲存時自動同步兩種格式

### 3. 靈活佈局
- 工具箱可拖曳到任意位置
- 節點可自由排列
- 自動排列功能快速整理

### 4. 完整保留
- 所有原編輯器功能
- 模組管理
- 腳本載入/儲存
- 快速指令按鈕

## 💡 使用技巧

1. **新手** - 從浮動工具箱點擊開始，視覺化理解流程
2. **熟練** - 使用左側積木列表快速添加，效率更高
3. **專家** - 切換文字模式直接編輯，精確控制
4. **協作** - 畫布模式便於演示，文字模式便於分享

## 🐛 常見問題

### Q: 工具箱被擋住了？
A: 拖曳標題列移動到其他位置，或點擊 "−" 暫時收起

### Q: 節點太亂了？
A: 右鍵畫布 → 自動排列，會垂直對齊所有節點

### Q: 想切回文字模式？
A: 點擊頂部右側「文字模式」按鈕即可切換

### Q: 畫布內容會儲存嗎？
A: 會！儲存時自動同步到文字，再轉換為 JSON 格式

## 📌 注意事項

1. **模式切換** - 切換前建議先儲存，避免遺失編輯
2. **節點移動** - 拖曳時連接線會自動調整
3. **工具箱** - 左側標籤切換時，工具箱內容同步更新
4. **載入顯示** - 載入腳本時自動在畫布顯示（如在畫布模式）

---

**享受視覺化編輯的樂趣！** 🎨✨
