# 📦 UI Test 資料夾 - 完整內容

## 📁 檔案清單

```
UI Test/
├── blockly_script_editor.py    # 主程式（✅ 已完成）
├── 啟動編輯器.py                # 快速啟動器
├── test_editor.py               # 功能測試腳本
├── README.md                    # 原始說明文件
├── 使用說明.md                   # 詳細使用指南
├── 測試指南.md                   # 完整測試步驟
└── 更新說明.md                   # 本檔案
```

## 🎯 本次更新內容

### ✨ 核心改進：Figma 風格畫布模式

基於 `sample_0_figma_base.py` 的設計理念，將中間文字編輯器改造為：

#### 1. 視覺化畫布編輯
- **中央畫布區域**：深色網格背景 (#252526)
- **節點式編輯**：每個指令顯示為彩色節點
- **自動連接**：節點間自動繪製帶箭頭的連接線
- **自由拖曳**：節點可任意移動，連接線自動調整
- **視覺化流程**：一目了然的腳本執行順序

#### 2. 可拖曳浮動工具箱
- **標題列拖曳**：按住「🔧 工具箱」可移動到任意位置
- **最小化功能**：點擊「−」按鈕收起/展開
- **內容同步**：隨左側標籤切換自動更新工具
- **快速創建**：點擊工具即在畫布創建對應節點
- **四大分類**：
  * 操作標籤（藍色）：滑鼠相關操作
  * 鍵盤標籤（綠色）：鍵盤輸入操作
  * 控制標籤（橘色）：流程控制指令
  * 辨識標籤（紫色）：圖片/文字辨識

#### 3. 雙模式無縫切換
- **畫布模式**：視覺化節點編輯（預設）
- **文字模式**：傳統文字指令編輯
- **一鍵切換**：頂部右側「文字模式」按鈕
- **自動同步**：儲存時自動同步兩種格式

### 🔧 新增功能

#### 畫布操作
- `_create_canvas_node()` - 創建節點
- `_connect_nodes()` - 連接節點
- `_on_canvas_click()` - 點擊處理
- `_on_canvas_drag()` - 拖曳處理
- `_update_connections()` - 更新連接線
- `_clear_canvas()` - 清空畫布
- `_auto_arrange_nodes()` - 自動排列
- `_canvas_to_text()` - 轉換為文字

#### 工具箱功能
- `_create_floating_toolbox()` - 創建浮動工具箱
- `_update_toolbox_content()` - 更新工具內容
- `_start_drag_toolbox()` - 開始拖曳工具箱
- `_drag_toolbox()` - 拖曳工具箱
- `_toggle_toolbox()` - 切換最小化狀態

#### 數據處理
- `_load_actions_to_canvas()` - 載入動作到畫布
- `_sync_canvas_to_text()` - 同步畫布到文字
- `_toggle_editor_mode()` - 切換編輯器模式
- `_show_canvas_context_menu()` - 顯示畫布右鍵選單

### 🎨 UI 改進

#### 配色方案
- **畫布背景**：#252526（VS Code 深色）
- **網格線**：#2d2d2d（微妙的網格）
- **工具箱**：#2c2c2c（深灰色面板）
- **標題列**：#3c3c3c（稍亮的灰色）
- **節點顏色**：依功能分類（藍/綠/橘/紫）

#### 佈局優化
- **三欄式設計**：左工具箱(280px) + 中畫布(展開) + 右屬性(320px)
- **浮動元素**：工具箱可自由定位
- **網格對齊**：30px 網格輔助排列
- **自動間距**：節點間 80px 垂直間距

### 📊 測試腳本

創建了 **blockly_demo_script.json**，包含：
- ✅ 18 個複雜動作序列
- ✅ 涵蓋滑鼠、鍵盤、延遲、組合鍵
- ✅ 模擬真實使用場景
- ✅ 設定重複執行 3 次
- ✅ 完整的參數配置

### 📚 文件更新

#### 使用說明.md
- Figma 風格畫布使用指南
- 浮動工具箱操作說明
- 四大工具分類詳解
- 畫布操作技巧
- 模式切換說明

#### 測試指南.md
- 10 步完整測試流程
- 測試腳本詳細說明
- 預期結果檢查
- 故障排除方案
- 測試檢查清單

#### test_editor.py
- 8 項自動化測試
- 功能完整性檢查
- 組件初始化驗證
- JSON 轉換測試
- 方法存在性檢查

## 🚀 使用流程

### 快速開始
```bash
cd "c:\Users\Lucien\Documents\GitHub\ChroLens_Mimic\main\UI Test"
python blockly_script_editor.py
```

### 推薦工作流程
1. **視覺化設計階段**
   - 使用畫布模式
   - 從浮動工具箱或左側積木創建節點
   - 拖曳節點排列流程
   - 觀察自動連接效果

2. **精確調整階段**
   - 切換到文字模式
   - 修改具體參數（座標、延遲時間等）
   - 享受語法高亮

3. **測試執行階段**
   - 儲存腳本
   - 在主程式 ChroLens_Mimic.py 執行
   - 觀察執行效果

4. **迭代優化階段**
   - 重新載入腳本
   - 在畫布上添加/移除節點
   - 或文字模式精確編輯
   - 再次儲存測試

## 🎯 核心優勢

### vs 傳統文字編輯器
- ✅ **視覺化**：流程一目了然
- ✅ **直觀**：拖曳操作更自然
- ✅ **靈活**：雙模式隨時切換
- ✅ **高效**：工具箱快速創建

### vs 純 Blockly 積木
- ✅ **精確**：可切換文字模式精確編輯
- ✅ **靈活**：不受積木限制
- ✅ **相容**：與原格式完全相容
- ✅ **高效**：文字模式編輯更快

### 兼具兩者優點
- 🎨 Figma 風格的視覺美感
- 📝 文字編輯的精確控制
- 🔄 無縫雙向同步
- 💾 完整的功能保留

## ✅ 功能檢查表

### 核心功能
- [x] 畫布模式節點編輯
- [x] 文字模式指令編輯
- [x] 雙模式無縫切換
- [x] 腳本載入/儲存
- [x] JSON 雙向轉換
- [x] 語法高亮顯示

### 畫布功能
- [x] 創建節點
- [x] 拖曳節點
- [x] 自動連接
- [x] 連接線調整
- [x] 自動排列
- [x] 清空畫布
- [x] 右鍵選單

### 工具箱功能
- [x] 浮動定位
- [x] 自由拖曳
- [x] 最小化/展開
- [x] 內容同步
- [x] 點擊創建
- [x] 四大分類

### 輔助功能
- [x] 模組管理
- [x] 快速指令
- [x] 屬性設定
- [x] 腳本列表
- [x] 圖示顯示
- [x] 字體支援

## 🎉 成果總結

### 已完成
- ✅ 基於 sample_13 的 Blockly UI 風格
- ✅ 基於 sample_0 的 Figma 畫布設計
- ✅ 整合 text_script_editor 完整功能
- ✅ 可拖曳浮動工具箱
- ✅ 視覺化節點編輯
- ✅ 雙模式無縫切換
- ✅ 完整測試腳本
- ✅ 詳盡使用文件

### 技術亮點
- 🎨 三欄式 Blockly 佈局
- 🖱️ 浮動可拖曳工具箱
- 🎯 畫布節點式編輯
- 🔄 雙模式自動同步
- 📦 模組化程式架構
- ✨ 現代化 UI 設計

### 使用體驗
- 👁️ 視覺化流程清晰
- 🖐️ 拖曳操作直觀
- ⚡ 工具箱快速創建
- 🔀 模式切換靈活
- 💾 功能完整保留
- 🎯 學習曲線平緩

## 📞 支援資源

- **主程式**：blockly_script_editor.py
- **使用說明**：使用說明.md
- **測試指南**：測試指南.md
- **測試腳本**：test_editor.py
- **範例腳本**：../scripts/blockly_demo_script.json

## 🌟 開始使用

1. 閱讀 [測試指南.md](測試指南.md) 了解完整測試步驟
2. 執行 `python test_editor.py` 驗證功能
3. 啟動 `python blockly_script_editor.py`
4. 載入 blockly_demo_script 查看效果
5. 開始創建你的自動化腳本！

---

**ChroLens Blockly Editor v2.0** - 視覺化與文字編輯完美結合！ 🎨✨
